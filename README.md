<p align="center"><a href="README_en.md">English</a></p>

# YOLOFuseï¼šé¢å‘å¤šæ¨¡æ€ç›®æ ‡æ£€æµ‹çš„åŒæµèåˆæ¡†æ¶

<p align="center">
  <img src="examples/Images/rgbir.png" alt="RGB-IRåŒæ¨¡æ€èåˆæ¶æ„ç¤ºæ„å›¾" width="600"/>
</p>

**YOLOFuse** æ˜¯åŸºäº [Ultralytics YOLO](https://github.com/ultralytics/ultralytics) æ¡†æ¶æ„å»ºçš„å¢å¼ºå‹ç›®æ ‡æ£€æµ‹ç³»ç»Ÿï¼Œä¸“ä¸ºå¤šæ¨¡æ€æ„ŸçŸ¥ä»»åŠ¡è®¾è®¡ã€‚æœ¬æ¡†æ¶åˆ›æ–°æ€§åœ°å¼•å…¥åŒæµå¤„ç†æ¶æ„ï¼Œæ”¯æŒRGBä¸çº¢å¤–ï¼ˆIRï¼‰å›¾åƒçš„ååŒåˆ†æä¸ç‰¹å¾èåˆï¼Œæ˜¾è‘—æå‡å¤æ‚ç¯å¢ƒï¼ˆä½ç…§åº¦ã€çƒŸé›¾é®æŒ¡ã€æç«¯å¤©æ°”ç­‰ï¼‰ä¸‹çš„æ£€æµ‹é²æ£’æ€§ã€‚é€‚ç”¨äºå®‰é˜²ç›‘æ§ã€ç¾å®³æ•‘æ´ã€å·¥ä¸šå·¡æ£€ç­‰å…³é”®åœºæ™¯ã€‚

---

## âœ¨ æŠ€æœ¯ç‰¹æ€§

* ğŸš€ **å¼‚æ„æ•°æ®èåˆ**ï¼šå®ç°RGBä¸IRå›¾åƒï¼ˆå¯æ‰©å±•è‡³RGB-Dç­‰æ¨¡æ€ï¼‰çš„ç«¯åˆ°ç«¯è”åˆå¤„ç†
* ğŸ”§ **å…¼å®¹YOLOv8 API**ï¼šä¿ç•™åŸç”Ÿæ¥å£è§„èŒƒï¼Œç¡®ä¿ç”¨æˆ·è¿ç§»æˆæœ¬æœ€å°åŒ–
* ğŸ” **å¯æ‰©å±•èåˆæ¨¡å—**ï¼šæä¾›å¤šå±‚æ¬¡èåˆç­–ç•¥ï¼Œæ”¯æŒï¼š
  - âœ… æ•°æ®çº§èåˆï¼ˆData-level Fusionï¼‰
  - âœ… å†³ç­–çº§èåˆï¼ˆDecision-level Fusionï¼‰
  - âœ… æ—©æœŸç‰¹å¾èåˆï¼ˆEarly Feature Fusionï¼‰
  - âœ… ä¸­æœŸç‰¹å¾èåˆï¼ˆMid-level Feature Fusionï¼‰

---

## ğŸ“Š LLVIPåŸºå‡†æµ‹è¯•ç»“æœ

| æ¨¡å‹æ¶æ„               | æ¨¡æ€   | ç²¾åº¦(P) | å¬å›ç‡(R) | mAP50 | mAP50-95 | æ¨¡å‹å¤§å°(MB) | è®¡ç®—é‡(GFLOPs) |
| ---------------------- | ------ | ------- | --------- | ----- | -------- | ------------ | -------------- |
| yolov8n (baseline)     | RGB    | 0.888   | 0.829     | 0.891 | 0.500    | 6.2          | 8.1            |
| yolo-fuse-ä¸­æœŸç‰¹å¾èåˆ | RGB+IR | 0.951   | 0.881     | 0.947 | 0.601    | 2.61         | 3.2            |
| yolo-fuse-æ—©æœŸç‰¹å¾èåˆ | RGB+IR | 0.950   | 0.896     | 0.955 | 0.623    | 5.2          | 6.7            |

---

## ğŸ§© æ•°æ®è¾“å…¥è§„èŒƒ

ç³»ç»Ÿé€šè¿‡æ–‡ä»¶åè‡ªåŠ¨å…³è”å¼‚æ„æ•°æ®æºï¼Œéœ€ç¡®ä¿æ–‡ä»¶å‘½åä¸€è‡´æ€§ï¼š

```
æ•°æ®é›†ç›®å½•/
â”œâ”€â”€ images/        # RGBå›¾åƒ
â”‚   â””â”€â”€ 120270.jpg 
â””â”€â”€ imagesIR/      # çº¢å¤–å›¾åƒï¼ˆåŒçº§ç›®å½•ï¼‰
    â””â”€â”€ 120270.jpg  # åŒåIRæ–‡ä»¶
```

> æ ‡æ³¨æ–‡ä»¶ä»…éœ€åŸºäºRGBå›¾åƒç”Ÿæˆï¼Œç³»ç»Ÿè‡ªåŠ¨å¤ç”¨è‡³IRæ¨¡æ€

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

### 1ï¸âƒ£ ç¯å¢ƒåˆå§‹åŒ–

```bash
git clone https://github.com/WangQvQ/YOLOFuse.git
cd YOLOFuse
pip install -e .  # å¯ç¼–è¾‘æ¨¡å¼å®‰è£…
```

### 2ï¸âƒ£ æ¨¡å‹è®­ç»ƒ

```bash
python train_dual.py  # å¯åŠ¨åŒæµè®­ç»ƒ
```

### 3ï¸âƒ£ æ¨ç†éªŒè¯

```bash
python infer_dual.py  # æ‰§è¡Œèåˆæ¨ç†
```

> é¢„è®­ç»ƒæƒé‡ä¸‹è½½ï¼š[å¤¸å…‹ç½‘ç›˜](https://pan.quark.cn/s/5e8f1c94ae5d)

---

## ğŸ“‚ æ•°æ®é›†ç»“æ„

é‡‡ç”¨æ ‡å‡†YOLOæ ¼å¼ï¼Œç›®å½•ç»“æ„ç¤ºä¾‹å¦‚ä¸‹ï¼š

```
datasets/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/    # RGBè®­ç»ƒé›†
â”‚   â””â”€â”€ val/      # RGBéªŒè¯é›†
â”œâ”€â”€ imagesIR/     # IRå›¾åƒé›†ï¼ˆä¸imagesç›®å½•åŒçº§ï¼‰
â”‚   â”œâ”€â”€ train/
â”‚   â””â”€â”€ val/
â””â”€â”€ labels/       # ç»Ÿä¸€æ ‡æ³¨æ–‡ä»¶
    â”œâ”€â”€ train/
    â””â”€â”€ val/
```

---

## âš¡ AutoDLäº‘ç«¯éƒ¨ç½²æ–¹æ¡ˆ

[[Open in AutoDL]](https://www.codewithgpu.com/i/WangQvQ/YOLOFuse/YOLOFuse)

<p align="center">
  <img src="examples/Images/autodl.png" alt="AutoDLå¹³å°ç•Œé¢" width="400"/> 
</p>

<p align="center">
  <img src="examples/Images/dutodlcreate.png" alt="å®ä¾‹åˆ›å»ºæµç¨‹" width="400"/>
</p>

```bash
conda activate Ultralytics-RGB-IR
cd YOLOFuse

# è®­ç»ƒæ‰§è¡Œ
python train_dual.py

# æ¨ç†éªŒè¯
python infer_dual.py
```
